webpackJsonp([7],{292:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(308),a=i.n(n);for(var s in n)"default"!==s&&function(e){i.d(t,e,function(){return n[e]})}(s);var o=i(366),l=(i.n(o),i(70));var r=function(e){i(362)},c=Object(l.a)(a.a,o.render,o.staticRenderFns,!1,r,null,null);t.default=c.exports},308:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i(364),s=(n=a)&&n.__esModule?n:{default:n};t.default={data:function(){return{edImage:!1,isShowEdFlag:!1,user:{nick_name:null,pic:null},rules:{nick_name:[{required:!0,message:"不能为空"}]}}},watch:{$gmxUserMsg:{handler:function(e){console.log(this),this.user.nick_name=(e||{}).nick_name,this.user.pic=(e||{}).pic,this.user.pic=this.user.pic?""+this.user.pic:this.userDefaultImg},deep:!0,immediate:!0}},methods:{getImage:function(e){var t=this;this.$store.dispatch("auth/uploadFile",{file:e}).then(function(e){e.flag;var i=e.data;e.errMsg;t.user.pic=""+i.path,t.edImage=!1})},modifyBtn:function(){var e=this;this.$refs.form.validate().then(function(t){t&&e.$store.dispatch("auth/changeUserMsg",{pic:e.user.pic,nick_name:e.user.nick_name}).then(function(e){var t=e.flag,i=e.data;e.errMsg;console.log(i,t)})})}},created:function(){this.$gMxpageLoad(!1)},components:{clipImage:s.default}}},309:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i(71),s=(n=a)&&n.__esModule?n:{default:n},o=i(124);t.default={ctx:null,file:null,x:0,y:0,xV:0,yV:0,nX:0,nY:0,img:null,props:{src:{type:String,default:null},clip:{type:Object,default:function(){return{width:"100px",height:"100px"}}}},data:function(){return{isShow:!1,base64:null,scale:1.5,deg:0}},computed:{width:function(){var e=this.clip;return parseFloat(e.width.replace("px",""))},height:function(){var e=this.clip;return parseFloat(e.height.replace("px",""))}},mounted:function(){var e=this.$options,t=this.$refs,i=this.width,n=this.height;(0,s.default)(e,{ctx:t.ctx.getContext("2d"),file:t.file,nX:-i/2,nY:-n/2})},methods:{rotate:function(){var e=this.$options,t=this.draw;this.deg=(this.deg+Math.PI/2)%(2*Math.PI),t(e.img,e.nX+e.xV,e.nY+e.yV,this.scale,this.deg)},handleScale:function(e){var t=this.$options,i=this.draw,n=this.deg;e&&this.scale>.1&&(this.scale=this.scale-.1),!e&&this.scale<1.9&&(this.scale=this.scale+.1),t.img&&i(t.img,t.nX+t.xV,t.nY+t.yV,this.scale,n)},dispatchUpload:function(e){this.clearState();var t=this.$options.file;e.preventDefault(),t.click()},readFileMsg:function(){var e=this.$options.file,t=this.draw,i=this.createImage,n=this.$options,a=n.nX,s=n.nY,o=this.scale,l=this.deg,r=e.files[0],c=new FileReader;c.onload=function(n){i(n.target.result,function(e){t(e,a,s,o,l)});e.value=null},c.readAsDataURL(r)},createImage:function(e,t){var i=new Image;this.$el.append(i),i.className="base64-hidden",i.onload=function(){t(i)},i.src=e,this.$options.img=i},draw:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Math.PI,s=this.$options.ctx,o=this.width,l=this.height,r=e.offsetWidth,c=e.offsetHeight;s.save(),s.clearRect(0,0,o,l),s.translate(o/2,l/2,e),s.rotate(a),s.drawImage(e,t,i,r*n,c*n),s.restore()},handleClip:function(e){var t=this.handleMove,i=this.$options,n=this.deg;i.img&&((0,s.default)(this.$options,{x:e.screenX,y:e.screenY}),(0,o.on)({el:window,type:"mousemove",fn:t}),(0,o.once)({el:window,type:"mouseup",fn:function(e){switch(console.log("down"),n){case 0:(0,s.default)(i,{nX:i.nX+i.xV,nY:i.nY+i.yV,xV:0,yV:0});break;case Math.PI/2:(0,s.default)(i,{nX:i.nY+i.yV,nY:i.nX-i.xV,xV:0,yV:0});break;case Math.PI:(0,s.default)(i,{nX:i.nX-i.xV,nY:i.nY-i.yV,xV:0,yV:0});break;default:(0,s.default)(i,{nX:i.nY-i.yV,nY:i.nX+i.xV,xV:0,yV:0})}(0,o.off)({el:window,type:"mousemove",fn:t})}}))},handleMove:function(e){e.preventDefault(),e.stopPropagation();var t=this.$options,i=this.draw,n=this.scale,a=this.deg;switch((0,s.default)(t,{xV:e.screenX-t.x,yV:e.screenY-t.y}),a){case 0:i(t.img,t.nX+t.xV,t.nY+t.yV,n,a);break;case Math.PI/2:i(t.img,t.nY+t.yV,t.nX-t.xV,n,a);break;case Math.PI:i(t.img,t.nX-t.xV,t.nY-t.yV,n,a);break;default:i(t.img,t.nY-t.yV,t.nX+t.xV,n,a)}},clearState:function(){var e=this.$options,t=this.width,i=this.height;e.img&&(this.$el.removeChild(e.img),(0,s.default)(e,{x:0,y:0,xV:0,yV:0,nX:-t/2,nY:-i/2,img:null}))},outFile:function(){var e=this,t=this.$refs.ctx;this.$options.file&&t.toBlob(function(t){e.$emit("sumbit",t)},{type:"image/png"})}}}},362:function(e,t,i){var n=i(363);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);i(282)("23a485c1",n,!0,{})},363:function(e,t,i){(e.exports=i(281)(!1)).push([e.i,".user-modify-container .person-img{position:relative;width:100px;height:100px;margin:0 auto;cursor:pointer;box-shadow:0 0 3px #5e5b5b}.user-modify-container .person-img:hover .upload-icon{display:block}.user-modify-container .person-img img{display:block;width:100%;height:100%}.user-modify-container .person-img .upload-icon{position:absolute;display:none;top:50%;left:50%;opacity:.8;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);font-size:65px;color:#d3d3d3}.user-modify-container .user-modify-form{position:relative;width:45%;margin:30px auto}.user-modify-container .special-btn-box .el-form-item__content{margin:0!important}",""])},364:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(309),a=i.n(n);for(var s in n)"default"!==s&&function(e){i.d(t,e,function(){return n[e]})}(s);var o=i(365),l=(i.n(o),i(70)),r=Object(l.a)(a.a,o.render,o.staticRenderFns,!1,null,null,null);t.default=r.exports},365:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.render=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"jc-clip-image",style:{width:""+e.clip.width}},[i("canvas",{ref:"ctx",attrs:{width:e.clip.width,height:e.clip.height},on:{mousedown:function(t){e.handleClip(t)}}}),e._v(" "),i("input",{ref:"file",attrs:{type:"file"},on:{change:function(t){e.readFileMsg(t)}}}),e._v(" "),i("div",{staticClass:"clip-scale-btn"},[i("a",{staticClass:"add",on:{click:function(t){e.handleScale(!1)}}},[e._v("+")]),e._v(" "),i("a",{staticClass:"right-rotate",on:{click:e.rotate}},[e._v("转")]),e._v(" "),i("a",{staticClass:"poor",on:{click:function(t){e.handleScale(!0)}}},[e._v("-")])]),e._v(" "),i("div",{staticClass:"upload-warp"},[i("a",{staticClass:"upload-btn",on:{click:function(t){e.dispatchUpload(t)}}},[e._v("选择")]),e._v(" "),i("a",{staticClass:"upload-make-true",on:{click:e.outFile}},[e._v("确定")])])])},t.staticRenderFns=[]},366:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.render=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"user-modify-container"},[e.edImage?e._e():i("section",{staticClass:"person-img"},[i("img",{attrs:{src:e.user.pic,alt:""}}),e._v(" "),i("i",{staticClass:"el-icon-plus upload-icon",on:{click:function(t){e.edImage=!0}}})]),e._v(" "),i("el-dialog",{attrs:{title:"修改图片",visible:e.edImage},on:{"update:visible":function(t){e.edImage=t}}},[e.edImage?i("clip-image",{on:{sumbit:e.getImage}}):e._e()],1),e._v(" "),i("el-form",{ref:"form",staticClass:"user-modify-form",attrs:{model:e.user,rules:e.rules,"label-width":"80px","label-position":"left"}},[i("el-form-item",{attrs:{label:"昵称",prop:"nick_name"}},[i("el-input",{model:{value:e.user.nick_name,callback:function(t){e.$set(e.user,"nick_name",t)},expression:"user.nick_name"}})],1),e._v(" "),i("el-form-item",{staticClass:"special-btn-box",staticStyle:{"text-align":"center"},attrs:{"label-width":"0"}},[i("el-button",{attrs:{type:"primary"},on:{click:e.modifyBtn}},[e._v("\n                确定\n            ")])],1)],1)],1)},t.staticRenderFns=[]}});